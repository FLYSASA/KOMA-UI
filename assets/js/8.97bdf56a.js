(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{499:function(t,e,n){},501:function(t,e,n){"use strict";var i=n(499);n.n(i).a},503:function(t,e,n){"use strict";n(167);var i={name:"KomaButton",components:{"k-icon":n(500).a},props:{icon:{type:String,default:""},iconPosition:{type:String,default:"left",validator:function(t){return["left","right"].includes(t)}},loading:{type:Boolean,default:!1}}},a=(n(501),n(42)),o=Object(a.a)(i,(function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("button",{staticClass:"koma-button",class:(t={},t["icon-"+e.iconPosition]=!0,t),on:{click:function(t){return e.$emit("click")}}},[e.loading?i("k-icon",{staticClass:"loading icon",attrs:{name:"loading"}}):e._e(),e._v(" "),e.icon&&!e.loading?i("k-icon",{staticClass:"icon",attrs:{name:e.icon}}):e._e(),e._v(" "),i("div",{staticClass:"content"},[e._t("default")],2)],1)}),[],!1,null,"6acacc07",null);e.a=o.exports},507:function(t,e,n){"use strict";var i=n(1),a=n(100),o=n(44),r=n(13),s=n(11),l=n(101),c=n(46),u=n(45),p=n(18),f=u("splice"),d=p("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min;i({target:"Array",proto:!0,forced:!f||!d},{splice:function(t,e){var n,i,u,p,f,d,v=s(this),g=r(v.length),k=a(t,g),y=arguments.length;if(0===y?n=i=0:1===y?(n=0,i=g-k):(n=y-2,i=h(m(o(e),0),g-k)),g+n-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(u=l(v,i),p=0;p<i;p++)(f=k+p)in v&&c(u,p,v[f]);if(u.length=i,n<i){for(p=k;p<g-i;p++)d=p+n,(f=p+i)in v?v[d]=v[f]:delete v[d];for(p=g;p>g-i+n;p--)delete v[p-1]}else if(n>i)for(p=g-i;p>k;p--)d=p+n-1,(f=p+i-1)in v?v[d]=v[f]:delete v[d];for(p=0;p<n;p++)v[p+k]=arguments[p+2];return v.length=g-i+n,u}})},592:function(t,e,n){},593:function(t,e,n){},683:function(t,e,n){var i=n(1),a=n(684);i({target:"Array",proto:!0,forced:a!==[].lastIndexOf},{lastIndexOf:a})},684:function(t,e,n){"use strict";var i=n(15),a=n(44),o=n(13),r=n(33),s=n(18),l=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,p=r("lastIndexOf"),f=s("indexOf",{ACCESSORS:!0,1:0}),d=u||!p||!f;t.exports=d?function(t){if(u)return c.apply(this,arguments)||0;var e=i(this),n=o(e.length),r=n-1;for(arguments.length>1&&(r=l(r,a(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in e&&e[r]===t)return r||0;return-1}:c},685:function(t,e,n){"use strict";var i=n(592);n.n(i).a},686:function(t,e,n){"use strict";var i=n(593);n.n(i).a},705:function(t,e,n){"use strict";n.r(e);n(169),n(24),n(102),n(166),n(683),n(72),n(168),n(507),n(71),n(504),n(26);var i=n(40);var a={get:function(){},post:function(t,e){return function(t,e,n){var i=new XMLHttpRequest;i.open(t,e),i.onload=function(){n.success&&n.success(i.response)},i.onerror=function(){n.fail&&n.fail(i)},i.send(n.formData)}("post",t,e)},put:function(){},delete:function(){},patch:function(){}},o={name:"KomaUploader",components:{KIcon:n(500).a},props:{name:{type:String,default:"file"},action:{type:String,required:!0},method:{type:String,default:"POST"},parseResponse:{type:Function,required:!0},fileList:{type:Array,default:function(){return[]}},sizeLimit:{type:Number},accept:{type:String,default:"*"},multiple:{type:Boolean,default:!1}},data:function(){return{imgUrl:""}},methods:{onRemoveFile:function(t){if(window.confirm("确定删除该文件吗？")){var e=Object(i.a)(this.fileList),n=this.fileList.indexOf(t);e.splice(n,1),this.$emit("update:fileList",e)}},createInput:function(){this.$refs.temp.innerHTML="";var t=document.createElement("input");return t.type="file",t.accept=this.accept,t.multiple=this.multiple,this.$refs.temp.appendChild(t),t},onClickUpload:function(){var t=this,e=this.createInput();e.addEventListener("change",(function(n){var i=e.files;t.uploadFile(i),e.remove()})),e.click()},beforeUploadFile:function(t,e){t=Array.from(t);for(var n=0;n<t.length;n++){var a=t[n];a.type;if(a.size>this.sizeLimit)return this.$emit("error","文件大于2MB"),!1}var o=t.map((function(t,n){return{name:e[n],type:t.type,size:t.size,status:"uploading"}}));return this.$emit("update:fileList",[].concat(Object(i.a)(this.fileList),Object(i.a)(o))),!0},afterUploadFile:function(t,e){var n=JSON.parse(JSON.stringify(this.fileList));n.some((function(n){if(n.name===t)return n.url=e,n.status="success",!0})),this.$emit("update:fileList",n),this.$emit("uploaded")},uploadError:function(t,e){var n=JSON.parse(JSON.stringify(this.fileList));n.some((function(e){if(e.name===t)return e.status="fail",!0})),this.$emit("update:fileList",n);var i="";0===e.status&&(i="网络无法连接"),this.$emit("error",i)},uploadFile:function(t){for(var e=this,n=[],i=0;i<t.length;i++){var a=t[i].name,o=this.generateName(a);n[i]=o}if(this.beforeUploadFile(t,n))for(var r=function(i){var a=t[i],o=(a.name,a.type,a.size,n[i]),r=new FormData;r.append(e.name,a),e.doUploadFile(r,(function(t){e.imgUrl=e.parseResponse(t),e.afterUploadFile(o,e.imgUrl)}),(function(t){e.uploadError(o,t)}))},s=0;s<t.length;s++)r(s)},doUploadFile:function(t,e,n){a[this.method.toLowerCase()](this.action,{success:e,fail:n,formData:t})},generateName:function(t){for(;this.fileList.filter((function(e){return e.name===t})).length>0;){var e=t.lastIndexOf("."),n=t.substring(0,e),i=t.substring(e);t=n+"(1)"+i}return t}}},r=(n(685),n(42)),s=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"koma-uploader"},[n("div",{ref:"trigger",on:{click:t.onClickUpload}},[t._t("default")],2),t._v(" "),t._t("tips"),t._v(" "),n("div",{ref:"temp",staticStyle:{display:"none"}}),t._v(" "),n("ol",{staticClass:"koma-uploader-fileList"},t._l(t.fileList,(function(e){var i;return n("li",{key:e.name},["uploading"===e.status?[n("k-icon",{staticClass:"loading-icon",attrs:{name:"loading"}})]:t._e(),t._v(" "),n("div",{staticClass:"image-wrapper"},[0===e.type.indexOf("image")?[e.url?n("img",{attrs:{src:e.url,width:"32",height:"32",alt:""}}):n("k-icon",{staticClass:"file-icon",attrs:{name:"file"}})]:[n("div",{staticClass:"koma-uploader-defaultImage"})]],2),t._v(" "),n("span",{staticClass:"file-name",class:(i={},i[e.status]=e.status,i)},[t._v(t._s(e.name))]),t._v(" "),n("k-icon",{staticClass:"delete-btn",attrs:{name:"delete"},on:{click:function(n){return t.onRemoveFile(e)}}})],2)})),0)],2)}),[],!1,null,"df6275bc",null).exports,l=n(503),c={name:"KomaDatePickerDemo",components:{demosComponent:n(502).default,"k-upload":s,"k-button":l.a},props:{},data:function(){return{fileList:[],fileList2:[],codeStr1:'\n        <k-upload accept="image/*"\n          :file-list.sync="fileList"\n          :parseResponse="parseResponse" \n          action="http://127.0.0.1:3000/upload"\n          name="file">\n          <k-button icon="upload">上传</k-button>\n        </k-upload>\n\n        data() {\n          return {\n            fileList: [],\n          }\n        },\n        methods: {\n          parseResponse(res){\n            let url = \'http://127.0.0.1:3000/preview/\' + res.id\n            return url;\n          },\n        }\n      ',codeStr2:'\n        <k-upload accept="image/*"\n          :file-list.sync="fileList"\n          :parseResponse="parseResponse" \n          action="http://127.0.0.1:3000/upload"\n          @error="onerror"\n          name="file">\n          <k-button icon="upload">上传</k-button>\n        </k-upload>\n\n        data() {\n          return {\n            fileList: [],\n          }\n        },\n        methods: {\n          onerror(error) {\n            alert(error)\n          },\n          parseResponse(res){\n            let url = \'http://127.0.0.1:3000/preview/\' + res.id\n            return url;\n          },\n        }\n\n      '}},methods:{onerror:function(t){alert(t)},parseResponse:function(t){return"http://127.0.0.1:3000/preview/".concat(JSON.parse(t).id)}}},u=(n(686),Object(r.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper cascader-demo"},[n("demos-component",{attrs:{name:"基础用法",demokey:"0",description:"简单的用法。",codedes:"parseResponse函数的作用是，文件上传成功后给uploader回传文件的预览地址。",codeStr:t.codeStr1},scopedSlots:t._u([{key:"code",fn:function(){return[n("k-upload",{attrs:{accept:"image/*","file-list":t.fileList,parseResponse:t.parseResponse,action:"http://127.0.0.1:3000/upload",name:"file"},on:{"update:fileList":function(e){t.fileList=e},"update:file-list":function(e){t.fileList=e}}},[n("k-button",{attrs:{icon:"upload"}},[t._v("上传")])],1)]},proxy:!0}])}),t._v(" "),n("demos-component",{attrs:{name:"上传失败提示",demokey:"1",description:"error事件会回传错误信息。",codeStr:t.codeStr2},scopedSlots:t._u([{key:"code",fn:function(){return[n("k-upload",{attrs:{accept:"image/*","file-list":t.fileList2,parseResponse:t.parseResponse,action:"http://127.0.0.1:3000/upload",name:"file"},on:{"update:fileList":function(e){t.fileList2=e},"update:file-list":function(e){t.fileList2=e},error:t.onerror}},[n("k-button",{attrs:{icon:"upload"}},[t._v("上传")])],1)]},proxy:!0}])})],1)}),[],!1,null,"3665c4c2",null));e.default=u.exports}}]);